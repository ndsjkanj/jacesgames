<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Jace‚Äôs Games</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

	<style>
		:root {
			--bg-deep: #0b0b11;
			--glass: rgba(255, 255, 255, .08);
			--border: rgba(255, 255, 255, .14);
			--accent: #ff69b4;
			/* hot pink particles vibe */
			--accent-soft: #ff9fd0;
			--text: #ffffff;
			--text-dim: #cfd2dc;
		}

		* {
			box-sizing: border-box;
		}

		html,
		body {
			height: 100%;
		}

		body {
			margin: 0;
			font-family: 'Poppins', system-ui, Segoe UI, Roboto, Arial, sans-serif;
			background: radial-gradient(ellipse at bottom, #141827 0%, #090a0f 70%, var(--bg-deep) 100%);
			color: var(--text);
			overflow-x: hidden;
		}

		/* Canvas background */
		#bgCanvas {
			position: fixed;
			inset: 0;
			z-index: -1;
			background: transparent;
		}

		/* Header */
		header {
			position: sticky;
			top: 0;
			z-index: 10;
			backdrop-filter: blur(10px);
			background: rgba(0, 0, 0, .35);
			border-bottom: 1px solid var(--border);
		}

		.wrap {
			max-width: 1100px;
			margin: 0 auto;
			padding: 16px 20px;
			display: flex;
			align-items: center;
			gap: 18px;
		}

		.brand {
			font-weight: 700;
			letter-spacing: .3px;
			font-size: 1.2rem;
			text-shadow: 0 0 10px rgba(255, 255, 255, .25);
		}

		nav {
			margin-left: auto;
			display: flex;
			gap: 16px;
			flex-wrap: wrap;
		}

		nav a {
			color: var(--text);
			text-decoration: none;
			font-weight: 600;
			opacity: .95;
			padding: 8px 10px;
			border-radius: 10px;
			border: 1px solid transparent;
			transition: .2s;
		}

		nav a:hover {
			border-color: var(--border);
			background: var(--glass);
		}

		/* Hero */
		.hero {
			max-width: 1100px;
			margin: 60px auto 30px;
			padding: 0 20px;
			text-align: center;
		}

		.hero h1 {
			margin: 0 0 6px;
			font-size: clamp(28px, 4vw, 44px);
			text-shadow: 0 0 20px rgba(255, 105, 180, .25);
		}

		.hero p {
			color: var(--text-dim);
			margin: 8px 0 0;
		}

		/* Sections (glass cards) */
		.sections {
			max-width: 1100px;
			margin: 30px auto;
			padding: 0 20px;
			display: grid;
			gap: 18px;
		}

		.card {
			background: var(--glass);
			border: 1px solid var(--border);
			border-radius: 18px;
			padding: 18px;
			box-shadow: 0 20px 60px rgba(0, 0, 0, .25);
		}

		.card h2 {
			margin: 0 0 8px;
			font-size: 1.2rem;
		}

		.features {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
			gap: 12px;
		}

		.feature {
			border: 1px solid var(--border);
			background: rgba(255, 255, 255, .05);
			border-radius: 14px;
			padding: 12px;
		}

		.chip {
			display: inline-block;
			padding: 4px 8px;
			border-radius: 999px;
			font-size: .78rem;
			font-weight: 700;
			background: rgba(255, 105, 180, .18);
			color: #ffd7ec;
			border: 1px solid rgba(255, 105, 180, .35);
		}

		/* Kobe quote */
		.kobe {
			display: flex;
			gap: 14px;
			align-items: flex-start;
			flex-wrap: wrap;
		}

		.kobe .lead {
			font-weight: 700;
			color: #ffd7ec;
		}

		footer {
			max-width: 1100px;
			margin: 40px auto;
			padding: 14px 20px;
			color: var(--text-dim);
			text-align: center;
			font-size: .9rem;
		}

		/* CTA buttons */
		.cta {
			display: inline-flex;
			align-items: center;
			gap: 10px;
			margin-top: 18px;
		}

		.btn {
			border: 1px solid var(--border);
			background: var(--glass);
			color: var(--text);
			padding: 10px 14px;
			border-radius: 12px;
			text-decoration: none;
			font-weight: 700;
			transition: .2s;
		}

		.btn:hover {
			border-color: var(--accent-soft);
			box-shadow: 0 0 18px rgba(255, 105, 180, .25) inset;
		}

		.btn.primary {
			background: linear-gradient(135deg, rgba(255, 105, 180, .85), rgba(255, 180, 220, .65));
			color: #1b0b17;
			border: 1px solid rgba(255, 105, 180, .65);
		}
	</style>
</head>

<body>
	<!-- Pink particle canvas -->
	<canvas id="bgCanvas"></canvas>

	<!-- Header -->
	<header>
		<div class="wrap">
			<div class="brand">Jace‚Äôs Games</div>
			<nav>
				<a href="#home">Home</a>
				<a href="#features">Features</a>
				<a href="#kobe">Daily Kobe Quote</a>
				<a href="#" id="btnOpenGames">Games</a> <!-- will be wired up in Step 3 -->
			</nav>
		</div>
	</header>

	<!-- Hero -->
	<main id="home" class="hero">
		<h1>Welcome to Jace‚Äôs Galaxy üéÆ</h1>
		<p>Play and explore ‚Äî all in one clean, fast, modern hub.</p>
		<div class="cta">
			<a class="btn primary" href="#" id="ctaOpenGames">Open Games</a>
			<a class="btn" href="#features">See Features</a>
		</div>
	</main>

	<!-- Features -->
	<section id="features" class="sections">
		<div class="card">
			<h2>Features</h2>
			<div class="features">
				<div class="feature">
					<span class="chip">Fast Loader</span>
					<p>Games load inline with a smooth loader and a new-tab fallback if needed.</p>
				</div>
				<div class="feature">
					<span class="chip">Organized</span>
					<p>Browse by category. We‚Äôll add your categories one by one in the next step.</p>
				</div>
				<div class="feature">
					<span class="chip">Clean UI</span>
					<p>A modern, glassy aesthetic that stays readable and smooth.</p>
				</div>
				<div class="feature">
					<span class="chip">Daily Quote</span>
					<p>Fresh Kobe motivation every day to set the tone.</p>
				</div>
			</div>
		</div>
	</section>

	<!-- Daily Kobe Quote -->
	<section id="kobe" class="sections">
		<div class="card">
			<h2>Daily Kobe Quote</h2>
			<div class="kobe">
				<div class="lead">‚Äú<span id="kobeText">Loading...</span>‚Äù</div>
			</div>
		</div>
	</section>

	<footer>¬© <span id="year"></span> Jace‚Äôs Games ‚Äî All rights reserved.</footer>

	<!-- =========================
       Scripts for Step 1 only
       (Particles + Daily Kobe + Games button placeholder)
  ========================= -->
	<script>
		// Year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Daily Kobe Quote (simple deterministic picker by day-of-year)
    (function kobeDaily(){
      const quotes = [
        "The most important thing is to try and inspire people so that they can be great in whatever they want to do.",
        "Everything negative‚Äîpressure, challenges‚Äîis all an opportunity for me to rise.",
        "Rest at the end, not in the middle.",
        "Great things come from hard work and perseverance. No excuses.",
        "If you‚Äôre afraid to fail, then you‚Äôre probably going to fail.",
        "The moment you give up is the moment you let someone else win.",
        "Once you know what failure feels like, determination chases success.",
        "I create my own path. It was straight and narrow. I looked at it this way: you were either in my way, or out of it."
      ];
      const start = new Date(new Date().getFullYear(), 0, 0);
      const diff = new Date() - start;
      const day = Math.floor(diff / 86400000); // ms/day
      const q = quotes[day % quotes.length];
      const el = document.getElementById('kobeText');
      if (el) el.textContent = q;
    })();

    // Pink particle background
    (function pinkParticles(){
      const canvas = document.getElementById('bgCanvas');
      const ctx = canvas.getContext('2d');
      let W, H, particles;

      function resize(){
        W = canvas.width = window.innerWidth;
        H = canvas.height = window.innerHeight;
        // re-seed on resize
        particles = Array.from({length: Math.max(80, Math.floor(W*H/30000))}, () => ({
          x: Math.random()*W,
          y: Math.random()*H,
          r: Math.random()*1.8+0.6,
          vx: (Math.random()-0.5)*0.4,
          vy: (Math.random()-0.5)*0.4,
          a: Math.random()*0.6+0.25
        }));
      }
      window.addEventListener('resize', resize, {passive:true});
      resize();

      function tick(){
        ctx.clearRect(0,0,W,H);
        for (const p of particles){
          p.x += p.vx; p.y += p.vy;
          if (p.x<0||p.x>W) p.vx*=-1;
          if (p.y<0||p.y>H) p.vy*=-1;

          const g = ctx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r*6);
          g.addColorStop(0, `rgba(255,105,180,${p.a})`);
          g.addColorStop(1, 'rgba(255,105,180,0)');
          ctx.fillStyle = g;
          ctx.beginPath(); ctx.arc(p.x,p.y,p.r*6,0,Math.PI*2); ctx.fill();

          ctx.fillStyle = `rgba(255,159,208,${Math.min(1,p.a+0.15)})`;
          ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill();
        }
        requestAnimationFrame(tick);
      }
      tick();
    })();

    // Placeholder wiring so clicking ‚ÄúGames‚Äù doesn‚Äôt error yet
    document.getElementById('btnOpenGames').addEventListener('click', (e)=>{
      e.preventDefault();
      alert('Games panel will be added in Step 3. üëç');
    });
    document.getElementById('ctaOpenGames').addEventListener('click', (e)=>{
      e.preventDefault();
      document.getElementById('btnOpenGames').click();
    });
	</script>
<!-- ======== STEP 2: GAMES MODAL UI (paste this right before </body>) ======== -->
<style>
	/* Modal shell */
	.gm-backdrop {
		position: fixed;
		inset: 0;
		z-index: 50;
		background: rgba(0, 0, 0, .6);
		backdrop-filter: blur(6px);
		display: none;
		opacity: 0;
		transition: opacity .2s ease;
	}

	.gm-backdrop.show {
		display: block;
		opacity: 1;
	}

	.gm-panel {
		position: fixed;
		left: 50%;
		top: 50%;
		transform: translate(-50%, -50%) scale(.98);
		transition: transform .2s ease, opacity .2s ease;
		width: min(1050px, 92vw);
		max-height: 85vh;
		overflow: hidden;
		background: rgba(255, 255, 255, .06);
		border: 1px solid rgba(255, 255, 255, .14);
		border-radius: 18px;
		box-shadow: 0 30px 80px rgba(0, 0, 0, .45);
		opacity: 0;
	}

	.gm-backdrop.show .gm-panel {
		transform: translate(-50%, -50%) scale(1);
		opacity: 1;
	}

	.gm-head {
		display: flex;
		align-items: center;
		gap: 12px;
		padding: 14px 16px;
		border-bottom: 1px solid rgba(255, 255, 255, .14);
		background: linear-gradient(135deg, rgba(255, 105, 180, .18), rgba(255, 255, 255, .04));
	}

	.gm-title {
		font-weight: 700;
		letter-spacing: .3px;
	}

	.gm-spacer {
		flex: 1;
	}

	.gm-close {
		background: transparent;
		border: 1px solid rgba(255, 255, 255, .18);
		color: #fff;
		padding: 8px 10px;
		border-radius: 12px;
		cursor: pointer;
	}

	.gm-close:hover {
		border-color: rgba(255, 105, 180, .6);
		box-shadow: 0 0 12px rgba(255, 105, 180, .25) inset;
	}

	/* Tabs */
	.gm-tabs {
		display: flex;
		gap: 8px;
		flex-wrap: wrap;
		padding: 12px 16px;
		border-bottom: 1px solid rgba(255, 255, 255, .12);
		background: rgba(0, 0, 0, .12);
	}

	.gm-tab {
		padding: 8px 12px;
		border-radius: 999px;
		cursor: pointer;
		border: 1px solid rgba(255, 255, 255, .18);
		background: rgba(255, 255, 255, .06);
		color: #fff;
		font-weight: 600;
		font-size: .92rem;
		transition: .15s;
	}

	.gm-tab:hover {
		border-color: rgba(255, 105, 180, .6);
	}

	.gm-tab.active {
		background: linear-gradient(135deg, rgba(255, 105, 180, .9), rgba(255, 180, 220, .55));
		color: #1b0b17;
		border-color: rgba(255, 105, 180, .85);
	}

	/* Body layout */
	.gm-body {
		display: grid;
		grid-template-columns: 1fr 1.1fr;
		gap: 14px;
		padding: 14px 16px;
	}

	@media (max-width: 950px) {
		.gm-body {
			grid-template-columns: 1fr;
		}
	}

	/* Game list (left) */
	.gm-list {
		border: 1px solid rgba(255, 255, 255, .14);
		background: rgba(255, 255, 255, .04);
		border-radius: 14px;
		padding: 10px;
		max-height: 60vh;
		overflow: auto;
		/* ‚Üê scrolling */
	}

	.gm-list h3 {
		margin: 6px 8px 10px;
		font-size: 1rem;
		font-weight: 700;
		color: #ffd7ec;
		text-shadow: 0 0 12px rgba(255, 105, 180, .25);
	}

	.gm-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
		gap: 10px;
	}

	.gm-btn {
		width: 100%;
		text-align: left;
		cursor: pointer;
		padding: 12px;
		border-radius: 12px;
		border: 1px solid rgba(255, 255, 255, .16);
		background: rgba(255, 255, 255, .06);
		color: #fff;
		font-weight: 600;
		transition: .15s;
	}

	.gm-btn:hover {
		border-color: rgba(255, 105, 180, .6);
		box-shadow: 0 0 10px rgba(255, 105, 180, .2) inset;
	}

	/* Viewer (right) */
	.gm-view {
		border: 1px solid rgba(255, 255, 255, .14);
		background: rgba(255, 255, 255, .03);
		border-radius: 14px;
		padding: 0;
		min-height: 320px;
		display: flex;
		flex-direction: column;
	}

	.gm-view-head {
		display: flex;
		align-items: center;
		justify-content: space-between;
		gap: 8px;
		padding: 10px 12px;
		border-bottom: 1px solid rgba(255, 255, 255, .12);
	}

	.gm-view-title {
		font-weight: 700;
	}

	.gm-iframe-wrap {
		position: relative;
		flex: 1;
		background: #0c0c12;
	}

	.gm-iframe {
		width: 100%;
		height: 100%;
		border: 0;
		display: none;
	}

	.gm-empty {
		padding: 18px;
		color: #cfd2dc;
	}

	.gm-loader {
		position: absolute;
		inset: 0;
		display: grid;
		place-items: center;
		background: rgba(0, 0, 0, .2);
		opacity: 0;
		pointer-events: none;
		transition: .2s;
	}

	.gm-loader.show {
		opacity: 1;
		pointer-events: auto;
	}

	.gm-dot {
		width: 8px;
		height: 8px;
		border-radius: 50%;
		margin: 0 3px;
		display: inline-block;
		animation: gm-bounce 1s infinite ease-in-out;
		background: #ff69b4;
	}

	.gm-dot:nth-child(2) {
		animation-delay: .15s;
	}

	.gm-dot:nth-child(3) {
		animation-delay: .3s;
	}

	@keyframes gm-bounce {

		0%,
		80%,
		100% {
			transform: scale(0.6);
			opacity: .6;
		}

		40% {
			transform: scale(1);
			opacity: 1;
		}
	}
</style>

<!-- Backdrop + Panel -->
<div id="gamesModal" class="gm-backdrop" aria-hidden="true" role="dialog" aria-label="Games">
	<div class="gm-panel" role="document">
		<div class="gm-head">
			<div class="gm-title">Games</div>
			<div class="gm-spacer"></div>
			<button class="gm-close" id="gmCloseBtn" type="button">Close</button>
		</div>

		<!-- Tabs -->
		<div class="gm-tabs" id="gmTabs">
			<button class="gm-tab active" data-cat="popular" type="button">Most Popular</button>
			<button class="gm-tab" data-cat="action" type="button">Action & Arcade</button>
			<button class="gm-tab" data-cat="sports" type="button">Sports & Racing</button>
			<button class="gm-tab" data-cat="puzzle" type="button">Puzzle & Strategy</button>
			<button class="gm-tab" data-cat="retro" type="button">Retro & Emulators</button>
		</div>

		<!-- Body: List (left) + Viewer (right) -->
		<div class="gm-body">
			<!-- List -->
			<div class="gm-list">
				<h3 id="gmListTitle">Most Popular</h3>
				<div class="gm-grid" id="gmList">
					<!-- Step 3 will inject buttons here -->
					<button class="gm-btn" disabled>We‚Äôll add your games in Step 3 ‚Üí</button>
				</div>
			</div>

			<!-- Viewer -->
			<div class="gm-view">
				<div class="gm-view-head">
					<div class="gm-view-title" id="gmViewTitle">Select a game</div>
					<div class="gm-view-actions" id="gmViewActions" style="display:none;">
						<button class="gm-close" id="gmPopOut" type="button" title="Open in new tab">Pop-out</button>
					</div>
				</div>
				<div class="gm-iframe-wrap">
					<iframe id="gmFrame" class="gm-iframe" allow="fullscreen"></iframe>
					<div class="gm-loader" id="gmLoader">
						<div>
							<span class="gm-dot"></span><span class="gm-dot"></span><span class="gm-dot"></span>
						</div>
					</div>
					<div class="gm-empty" id="gmEmpty">Pick a game from the left to load it here.</div>
				</div>
			</div>
		</div>
	</div>
</div>

<script>
	/* ---------- Step 2 JS: open/close modal, tabs, safe rewire of header buttons ---------- */
(function gamesShell(){
  // Safely replace the old ‚Äúalert‚Äù listeners from Step 1 by cloning nodes
  function replaceWithClone(id, handler){
    const el = document.getElementById(id);
    if(!el) return null;
    const clone = el.cloneNode(true);
    el.parentNode.replaceChild(clone, el);
    clone.addEventListener('click', handler);
    return clone;
  }

  const modal = document.getElementById('gamesModal');
  const panel = modal.querySelector('.gm-panel');
  const gmClose = document.getElementById('gmCloseBtn');
  const gmTabs = document.getElementById('gmTabs');
  const gmListTitle = document.getElementById('gmListTitle');
  const gmList = document.getElementById('gmList');
  const gmViewTitle = document.getElementById('gmViewTitle');
  const gmFrame = document.getElementById('gmFrame');
  const gmLoader = document.getElementById('gmLoader');
  const gmEmpty = document.getElementById('gmEmpty');
  const gmPopOut = document.getElementById('gmPopOut');
  const btnOpen = replaceWithClone('btnOpenGames', (e)=>{ e.preventDefault(); openModal(); });
  const ctaOpen = replaceWithClone('ctaOpenGames', (e)=>{ e.preventDefault(); openModal(); });

  function openModal(){
    modal.classList.add('show');
    modal.setAttribute('aria-hidden','false');
    document.body.style.overflow = 'hidden';
  }
  function closeModal(){
    modal.classList.remove('show');
    modal.setAttribute('aria-hidden','true');
    document.body.style.overflow = '';
  }
  gmClose.addEventListener('click', closeModal);
  modal.addEventListener('click', (e)=>{ if(e.target === modal) closeModal(); });
  document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && modal.classList.contains('show')) closeModal(); });

  // Tabs ‚Üí just switch titles/placeholders for now. Step 3 injects games.
  gmTabs.addEventListener('click', (e)=>{
    const btn = e.target.closest('.gm-tab'); if(!btn) return;
    gmTabs.querySelectorAll('.gm-tab').forEach(t=>t.classList.remove('active'));
    btn.classList.add('active');

    const cat = btn.dataset.cat;
    const titleByCat = {
      popular: 'Most Popular',
      action: 'Action & Arcade',
      sports: 'Sports & Racing',
      puzzle: 'Puzzle & Strategy',
      retro: 'Retro & Emulators'
    };
    gmListTitle.textContent = titleByCat[cat] || 'Games';

    // reset list with placeholder (Step 3 will populate actual items)
    gmList.innerHTML = '<button class="gm-btn" disabled>Games for ‚Äú'+gmListTitle.textContent+'‚Äù will be added in Step 3 ‚Üí</button>';

    // reset viewer
    gmViewTitle.textContent = 'Select a game';
    gmFrame.style.display = 'none';
    gmFrame.src = 'about:blank';
    gmEmpty.style.display = 'block';
    document.getElementById('gmViewActions').style.display = 'none';
  });

  // These will be used in Step 3 when we wire real games
  window.__GM_OPEN = openModal;
  window.__GM_LOAD_GAME = function(name, url){
    gmViewTitle.textContent = name;
    gmEmpty.style.display = 'none';
    gmLoader.classList.add('show');
    gmFrame.style.display = 'block';
    gmFrame.src = url;
    document.getElementById('gmViewActions').style.display = 'block';
  };
  gmFrame.addEventListener('load', ()=> gmLoader.classList.remove('show'));
  gmPopOut.addEventListener('click', ()=>{
    if (gmFrame && gmFrame.src && gmFrame.src !== 'about:blank') {
      window.open(gmFrame.src, '_blank', 'noopener');
    }
  });
})();
</script>
<!-- ======== STEP 3: BIG GAMES DATA + RENDER (paste right before </body>) ======== -->
<script>
	/* CDN loader for single-file games */
const GM_CDN_BASE = 'https://cdn.jsdelivr.net/gh/bubbls/ugs-singlefile/';
const gmUrl = (id) => `${GM_CDN_BASE}${id}.html?t=${Date.now()}`;

/* 1) Many more games by category (all IDs come from your master list) */
const GAMES = {
  popular: [
    { name: 'Run 3', id: 'clrun3' },
    { name: 'Retro Bowl (Fixed)', id: 'clretrobowlfixed' },
    { name: 'Slope', id: 'clslope' },
    { name: 'Temple Run 2', id: 'cltemplerun2' },
    { name: 'Vex 7', id: 'clvex7' },
    { name: 'Geometry Dash Lite', id: 'clgeometrydashlite' },
    { name: 'Tunnel Rush', id: 'cltunnelrushbetter' },
    { name: 'Rooftop Snipers', id: 'clrooftopsnipers' },
    { name: 'Getaway Shootout', id: 'clgetawayshootout' },
    { name: 'Stickman Hook', id: 'clstickmanhook' },
    { name: 'Happy Wheels', id: 'clhappywheels' },
    { name: '2048', id: 'cl2048' },
    { name: 'Paper.io', id: 'clpaperio' },
    { name: 'Cookie Clicker', id: 'clcookieclicker' },
    { name: 'Drift Hunters', id: 'cldrifthunters' },
    { name: 'Smash Karts', id: 'clsmashkarts' },
    { name: 'Plants vs. Zombies', id: 'clplantsvszombies' },
    { name: 'Bloons TD 5', id: 'clbloonsTD5' }
  ],

  action: [
    { name: 'Run 3', id: 'clrun3' },
    { name: 'Slope', id: 'clslope' },
    { name: 'Temple Run 2', id: 'cltemplerun2' },
    { name: 'Vex 6', id: 'clvex6' },
    { name: 'Vex 7', id: 'clvex7' },
    { name: 'Vex 8', id: 'clvex8' },
    { name: 'Geometry Dash Lite', id: 'clgeometrydashlite' },
    { name: 'Tunnel Rush', id: 'cltunnelrushbetter' },
    { name: 'Rooftop Snipers', id: 'clrooftopsnipers' },
    { name: 'Getaway Shootout', id: 'clgetawayshootout' },
    { name: 'Stickman Hook', id: 'clstickmanhook' },
    { name: 'Happy Wheels', id: 'clhappywheels' },
    { name: "World's Hardest Game", id: 'clworldshardestgame' },
    { name: 'Cut the Rope', id: 'clcuttherope' },
    { name: 'Superhot', id: 'clsuperhot' },
    { name: 'House of Hazards', id: 'clhouseofhazards' },
    { name: 'Short Life', id: 'clshortlife' },
    { name: 'Time Shooter 3', id: 'cltimeshooter3' },
    { name: 'Raft Wars', id: 'clraftwars' },
    { name: 'Raft Wars 2', id: 'clraftwars2' },
    { name: 'Gun Mayhem', id: 'clgunmayhem' },
    { name: 'Gun Mayhem 2', id: 'clgunmayhem2' },
    { name: 'Gun Mayhem Redux', id: 'clgunmayhemredux' },
    { name: 'Raze', id: 'clraze' },
    { name: 'Raze 2', id: 'clraze2' },
    { name: 'Raze 3', id: 'clraze3' },
    { name: 'Stickman ‚Äì Stealing the Diamond', id: 'clstickmanstealingdiamond' },
    { name: 'Intrusion', id: 'clintrusion' },
    { name: 'Dead Zed', id: 'cldeadzed' },
    { name: 'Dead Zed 2', id: 'cldeadzed2' },
    { name: 'Decision 2', id: 'cldecision2' },
    { name: 'Decision 3', id: 'cldecision3' },
    { name: 'Strike Force Heroes', id: 'clstrikeforceheroes' },
    { name: 'Strike Force Heroes 2', id: 'clstrikeforceheroes2' },
    { name: 'Strike Force Heroes 3', id: 'clstrikeforceheroes3' }
  ],

  sports: [
    { name: 'Retro Bowl (Fixed)', id: 'clretrobowlfixed' },
    { name: 'Basketball Stars', id: 'clbasketballstars' },
    { name: 'Basketball Legends', id: 'clbasketballlegends' },
    { name: 'Soccer Random', id: 'clsoccerrandom' },
    { name: 'Football Legends', id: 'clfootballlegends' },
    { name: '1 on 1 Soccer', id: 'cl1on1soccer' },
    { name: 'Penalty Kicks', id: 'clpenaltykicks' },
    { name: 'Table Tennis World Tour', id: 'cltabletennisworldtour' },
    { name: 'Smash Karts', id: 'clsmashkarts' },
    { name: 'Drift Hunters', id: 'cldrifthunters' },
    { name: 'Madalin Stunt Cars', id: 'clmadalinstuntcars' },
    { name: 'Madalin Stunt Cars (Good)', id: 'clmadalinstuntcarsgood' },
    { name: 'Madalin Stunt Cars ‚Äì Multiplayer', id: 'clmadalinstuntcarsmultiplayerfixed' },
    { name: 'Two Ball 3D', id: 'cltwoball3d' },
    { name: 'Racing Arena', id: 'clracingarena' },
    { name: 'Top Speed Racing 3D', id: 'cltopspeedracing3d' },
    { name: 'Rocket League (Web)', id: 'clrocketleague' },
    { name: 'Goal South Africa', id: 'clgoalsouthafrica' },
    { name: '8 Ball Pool', id: 'cl8ballpool' },
    { name: 'Volley Random', id: 'clvolleyrandom' },
    { name: 'Basket Bros', id: 'clbasketbros' },
    { name: 'Soccer Bros', id: 'clsoccerbros' }
  ],

  puzzle: [
    { name: '2048', id: 'cl2048' },
    { name: 'Paper.io', id: 'clpaperio' },
    { name: 'Paper.io 3D', id: 'clpaperio3d' },
    { name: 'Cut the Rope', id: 'clcuttherope' },
    { name: 'Plants vs. Zombies', id: 'clplantsvszombies' },
    { name: 'Bloons TD 5', id: 'clbloonsTD5' },
    { name: 'Cookie Clicker', id: 'clcookieclicker' },
    { name: 'Stick War', id: 'clstickwar' },
    { name: 'Stick War 2', id: 'clstickwar2' },
    { name: 'Learn to Fly', id: 'cllearntofly' },
    { name: 'Learn to Fly 2', id: 'cllearntofly2' },
    { name: 'Learn to Fly 3', id: 'cllearntofly3' },
    { name: 'Factory Balls', id: 'clfactoryballs' },
    { name: 'Factory Balls 2', id: 'clfactoryballs2' },
    { name: 'Factory Balls 3', id: 'clfactoryballs3' },
    { name: 'Factory Balls 4', id: 'clfactoryballs4' },
    { name: 'Portal Flash', id: 'clportalflash' },
    { name: 'Portal 2D', id: 'clportal2d' },
    { name: 'Fireboy & Watergirl 1', id: 'clfireboyandwatergirl' },
    { name: 'Fireboy & Watergirl 2', id: 'clfireboyandwatergirl2' },
    { name: 'Fireboy & Watergirl 3', id: 'clfireboyandwatergirl3' },
    { name: 'Fireboy & Watergirl 5', id: 'clfireboyandwatergirl5' },
    { name: 'Fireboy & Watergirl 6', id: 'clfireboyandwatergirl6' },
    { name: 'Red Ball', id: 'clredball' },
    { name: 'Red Ball 2', id: 'clredball2' },
    { name: 'Red Ball 3', id: 'clredball3' },
    { name: 'Red Ball 4', id: 'clredball4' },
    { name: 'Red Ball 4 Vol. 2', id: 'clredball4vol2' },
    { name: 'Red Ball 4 Vol. 3', id: 'clredball4vol3' },
    { name: 'Suika Game', id: 'clsuika' },
    { name: 'Pull Frog', id: 'clpullfrog' },
    { name: 'Trap The Cat', id: 'cltrapthecat' },
    { name: 'Idle Breakout', id: 'clidlebreakout' },
    { name: 'Space Company (Idle)', id: 'clspacecompany' }
  ],

  retro: [
    { name: 'Super Mario 64', id: 'clsupermario64' },
    { name: 'Mario Kart 64', id: 'clmariokart64' },
    { name: 'Super Smash Bros (N64)', id: 'clsupersmashbros' },
    { name: 'GoldenEye 007', id: 'clgoldeneye007' },
    { name: 'Zelda: Ocarina of Time', id: 'clocarinaoftime' },
    { name: 'Donkey Kong Country', id: 'cldonkeykongcountry' },
    { name: 'Super Metroid', id: 'clsupermetroid' },
    { name: 'Castlevania: Aria of Sorrow', id: 'clcastlevaniaariaofsorrow' },
    { name: 'Pok√©mon Emerald', id: 'clpokemonemerald' },
    { name: 'Pok√©mon FireRed', id: 'clpokemonfirered' },
    { name: 'Sonic 3 & Knuckles', id: 'clsonic3andknuckles' },
    { name: 'Kirby Super Star', id: 'clkirbysuperstar' },
    { name: 'Metroid Fusion', id: 'clmetroidfusion' },
    { name: 'Super Mario World', id: 'clsupermarioworld' },
    { name: 'Wario Land 4', id: 'clwarioland4' },
    { name: 'Super Punch-Out!!', id: 'clsuperpunchout' },
    { name: 'F-Zero', id: 'clfzero' },
    { name: 'F-Zero X', id: 'clfzerox' },
    { name: 'Star Fox 64', id: 'clstarfox64' },
    { name: 'Star Fox (SNES)', id: 'clstarfox' },
    { name: 'Wave Race 64', id: 'clwaverace64' },
    { name: 'Tony Hawk‚Äôs Pro Skater 2', id: 'cltonyhawkskater2' },
    { name: 'Crash Bandicoot 2', id: 'clcrashbandicoot2' },
    { name: 'Paper Mario', id: 'clpapermario' },
    { name: 'Perfect Dark', id: 'clperfectdark' },
    { name: 'Mega Man X', id: 'clmegamanx' },
    { name: 'EarthBound', id: 'clearthbound' },
    { name: 'Chrono Trigger', id: 'clchronotrigger' }
  ]
};

/* 2) Render + wire buttons into the modal (left list) */
(function gamesPopulate(){
  const gmTabs = document.getElementById('gmTabs');
  const gmList = document.getElementById('gmList');
  const gmListTitle = document.getElementById('gmListTitle');

  function titleFor(cat){
    return ({
      popular: 'Most Popular',
      action: 'Action & Arcade',
      sports: 'Sports & Racing',
      puzzle: 'Puzzle & Strategy',
      retro: 'Retro & Emulators'
    })[cat] || 'Games';
  }

  function renderCategory(cat){
    const items = (GAMES[cat] || []);
    gmListTitle.textContent = titleFor(cat);
    if(!items.length){
      gmList.innerHTML = '<button class="gm-btn" disabled>No games here yet.</button>';
      return;
    }
    gmList.innerHTML = '';
    items.forEach(g => {
      const btn = document.createElement('button');
      btn.className = 'gm-btn';
      btn.textContent = g.name;
      btn.addEventListener('click', () => {
        const url = gmUrl(g.id);
        window.__GM_LOAD_GAME(g.name, url);
      });
      gmList.appendChild(btn);
    });
  }

  // Switch tabs
  gmTabs.addEventListener('click', (e)=>{
    const t = e.target.closest('.gm-tab'); if(!t) return;
    const cat = t.dataset.cat;
    gmTabs.querySelectorAll('.gm-tab').forEach(x=>x.classList.remove('active'));
    t.classList.add('active');
    renderCategory(cat);

    // Reset viewer side
    const gmViewTitle = document.getElementById('gmViewTitle');
    const gmFrame = document.getElementById('gmFrame');
    const gmEmpty = document.getElementById('gmEmpty');
    document.getElementById('gmViewActions').style.display = 'none';
    gmViewTitle.textContent = 'Select a game';
    gmFrame.src = 'about:blank';
    gmFrame.style.display = 'none';
    gmEmpty.style.display = 'block';
  });

  // Pre-populate Most Popular when modal opens
  if (typeof window.__GM_OPEN === 'function') {
    const oldOpen = window.__GM_OPEN;
    window.__GM_OPEN = function(){
      oldOpen();
      const first = gmTabs.querySelector('[data-cat="popular"]');
      if (first){
        gmTabs.querySelectorAll('.gm-tab').forEach(x=>x.classList.remove('active'));
        first.classList.add('active');
      }
      renderCategory('popular');
    };
  }

  // Initial safe render in case modal is already present
  renderCategory('popular');
})();
</script>
<!-- ======== STEP 4: HTML RUNNER + FULLSCREEN (paste right before </body>) ======== -->
<style>
	/* Inline loader for the game iframe */
	#gmLoader {
		position: absolute;
		inset: 0;
		display: none;
		align-items: center;
		justify-content: center;
		background: rgba(10, 10, 14, 0.35);
		backdrop-filter: blur(2px);
		z-index: 5;
	}

	.gm-spinner {
		width: 46px;
		height: 46px;
		border: 4px solid rgba(255, 255, 255, 0.25);
		border-top-color: #ff66cc;
		/* pink accent */
		border-radius: 50%;
		animation: gmspin 0.9s linear infinite;
	}

	@keyframes gmspin {
		to {
			transform: rotate(360deg);
		}
	}

	/* Ensure the viewer section can host absolute loader */
	.gm-view {
		position: relative;
		/* required for #gmLoader to sit on top */
		min-height: 360px;
	}

	/* Actions row looks tidy even if injected now */
	#gmViewActions {
		display: none;
		gap: 8px;
		margin-top: 10px;
	}

	#gmViewActions .gm-act {
		background: rgba(255, 255, 255, 0.08);
		color: #fff;
		border: 1px solid rgba(255, 255, 255, 0.18);
		border-radius: 10px;
		padding: 8px 12px;
		cursor: pointer;
		transition: transform .15s ease, background .2s ease;
	}

	#gmViewActions .gm-act:hover {
		transform: translateY(-1px);
		background: rgba(255, 102, 204, 0.22);
	}

	/* Make the games list panel scroll if it grows huge */
	#gmList {
		max-height: 60vh;
		overflow: auto;
	}
</style>

<script>
	/* 
  This file expects the following elements already exist from Steps 1‚Äì3:
  - #gmFrame (iframe where the game loads)
  - #gmEmpty (placeholder div when nothing selected)
  - #gmViewTitle (h3 title that shows current game name)
  - #gmViewActions (container for actions)
  - #gmModal (the modal)
  - .gm-view (the right pane that holds the iframe)
  If #gmViewActions is missing, we‚Äôll create it automatically.
*/

/* Utility: create the loader overlay if missing */
(function ensureLoader(){
  const view = document.querySelector('.gm-view');
  if (!view) return; // created in Step 1 layout
  if (!document.getElementById('gmLoader')) {
    const div = document.createElement('div');
    div.id = 'gmLoader';
    div.innerHTML = '<div class="gm-spinner" aria-label="Loading game‚Ä¶"></div>';
    view.appendChild(div);
  }
})();

/* Utility: ensure actions row + buttons exist */
(function ensureActions(){
  let actions = document.getElementById('gmViewActions');
  const view = document.querySelector('.gm-view');
  if (!view) return;
  if (!actions) {
    actions = document.createElement('div');
    actions.id = 'gmViewActions';
    view.appendChild(actions);
  }
  // Inject buttons only if they‚Äôre not there yet
  const need = (id) => !document.getElementById(id);
  if (need('gmBtnFull') || need('gmBtnPop') || need('gmBtnReload')) {
    actions.innerHTML = `
      <button id="gmBtnFull" class="gm-act" title="Fullscreen">Fullscreen</button>
      <button id="gmBtnPop" class="gm-act" title="Open in new tab">Pop-out</button>
      <button id="gmBtnReload" class="gm-act" title="Reload game">Reload</button>
    `;
  }
})();

/* Cache last loaded game so Pop-out/Reload work even after we revoke blob URLs */
window.__GM_LAST = { name: null, html: null };

/* Show/hide the loader overlay */
function __GM_setLoading(isLoading){
  const ld = document.getElementById('gmLoader');
  if (!ld) return;
  ld.style.display = isLoading ? 'flex' : 'none';
}

/* The runner: fetch HTML, stream into iframe via Blob, show loader, set title */
window.__GM_LOAD_GAME = async function(name, url){
  const gmFrame = document.getElementById('gmFrame');
  const gmEmpty = document.getElementById('gmEmpty');
  const gmViewTitle = document.getElementById('gmViewTitle');
  const gmViewActions = document.getElementById('gmViewActions');
  if (!gmFrame) return;

  // Reset viewer state
  gmViewTitle && (gmViewTitle.textContent = name || 'Loading‚Ä¶');
  gmEmpty && (gmEmpty.style.display = 'none');
  gmFrame.style.display = 'block';
  gmViewActions && (gmViewActions.style.display = 'none');

  __GM_setLoading(true);

  try {
    const res = await fetch(url, { cache: 'no-store' });
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    const html = await res.text();

    // Save for Pop-out / Reload
    window.__GM_LAST = { name, html };

    // Create a blob URL so X-Frame-Options on the source doesn‚Äôt block us
    const blob = new Blob([html], { type: 'text/html' });
    const blobUrl = URL.createObjectURL(blob);

    // Load in iframe; revoke blob URL after it finishes
    gmFrame.onload = () => {
      // give a tiny delay to ensure resources inside finish touching DOM
      setTimeout(() => {
        __GM_setLoading(false);
        gmViewActions && (gmViewActions.style.display = 'flex');
        URL.revokeObjectURL(blobUrl);
      }, 60);
    };
    gmFrame.onerror = () => {
      __GM_setLoading(false);
      gmFrame.style.display = 'none';
      if (gmEmpty) {
        gmEmpty.innerHTML = `
          <div style="opacity:.85">
            <p>Couldn‚Äôt embed this game. You can try Pop-out.</p>
          </div>`;
        gmEmpty.style.display = 'block';
      }
      gmViewActions && (gmViewActions.style.display = 'flex');
    };

    // Use srcdoc when available for slightly faster start; fall back to blob
    try {
      gmFrame.removeAttribute('src'); // clear previous
      gmFrame.srcdoc = html;
      // When using srcdoc, we still want loader to hide on first paint:
      // Add an onload fallback if the browser doesn‚Äôt fire it reliably
      setTimeout(() => {
        __GM_setLoading(false);
        gmViewActions && (gmViewActions.style.display = 'flex');
      }, 400);
    } catch {
      gmFrame.srcdoc = ''; // cleanup
      gmFrame.src = blobUrl;
    }

  } catch (err) {
    __GM_setLoading(false);
    gmFrame.style.display = 'none';
    const gmEmpty = document.getElementById('gmEmpty');
    if (gmEmpty) {
      gmEmpty.innerHTML = `
        <div style="opacity:.85">
          <p>Failed to load <strong>${name || 'game'}</strong>.<br>
            Error: ${String(err && err.message || err)}</p>
          <button class="gm-act" onclick="window.__GM_RETRY()">Retry</button>
        </div>`;
      gmEmpty.style.display = 'block';
    }
  }
};

/* Retry uses the last game we tried to fetch (rebuilds from saved HTML if present) */
window.__GM_RETRY = function(){
  const { name, html } = window.__GM_LAST || {};
  if (!name) return;
  const gmFrame = document.getElementById('gmFrame');
  const gmEmpty = document.getElementById('gmEmpty');
  const gmViewTitle = document.getElementById('gmViewTitle');
  const gmViewActions = document.getElementById('gmViewActions');

  gmEmpty && (gmEmpty.style.display = 'none');
  gmFrame.style.display = 'block';
  gmViewTitle && (gmViewTitle.textContent = name);

  if (html) {
    __GM_setLoading(true);
    // Rebuild the blob from cached html
    const blob = new Blob([html], { type: 'text/html' });
    const blobUrl = URL.createObjectURL(blob);
    gmFrame.onload = () => {
      setTimeout(() => {
        __GM_setLoading(false);
        gmViewActions && (gmViewActions.style.display = 'flex');
        URL.revokeObjectURL(blobUrl);
      }, 60);
    };
    try {
      gmFrame.srcdoc = html;
      setTimeout(() => {
        __GM_setLoading(false);
        gmViewActions && (gmViewActions.style.display = 'flex');
      }, 400);
    } catch {
      gmFrame.srcdoc = '';
      gmFrame.src = blobUrl;
    }
  }
};

/* Wire the three action buttons */
(function wireActions(){
  const btnFull = document.getElementById('gmBtnFull');
  const btnPop  = document.getElementById('gmBtnPop');
  const btnReload = document.getElementById('gmBtnReload');
  const view = document.querySelector('.gm-view');
  const frame = document.getElementById('gmFrame');

  // Fullscreen the game pane (esc exits)
  if (btnFull && view) {
    btnFull.addEventListener('click', async () => {
      try {
        if (!document.fullscreenElement) {
          await (view.requestFullscreen
            ? view.requestFullscreen()
            : view.webkitRequestFullscreen?.());
        } else {
          await document.exitFullscreen?.();
        }
      } catch(e) {
        console.warn('Fullscreen error:', e);
      }
    });
  }

  // Pop-out: write cached HTML to a new tab so it always works
  if (btnPop) {
    btnPop.addEventListener('click', () => {
      const { name, html } = window.__GM_LAST || {};
      if (!html) return;
      const win = window.open('about:blank', '_blank');
      if (win) {
        win.document.open();
        win.document.write(html);
        win.document.close();
        // Optionally set title
        try { win.document.title = name || 'Game'; } catch {}
      }
    });
  }

  // Reload the current game from cache (fast) or do nothing if none
  if (btnReload) {
    btnReload.addEventListener('click', () => {
      window.__GM_RETRY();
    });
  }

  // Make iframe take all available height (if CSS wasn‚Äôt set yet)
  if (frame) {
    frame.setAttribute('allow', 'autoplay; fullscreen; gamepad; cross-origin-isolated');
    frame.style.width = '100%';
    frame.style.height = '60vh';
    frame.style.border = '0';
  }
})();
</script>
<!-- ======== /STEP 4 ======== -->
</body>

</html>
